<div *ngIf="loading" class="text-center py-10 text-blue-800">
  Loading booking page...
</div>

<div *ngIf="error" class="text-center text-red-600 font-bold py-4">
  {{ error }}
</div>

<div *ngIf="!loading && service" class="max-w-3xl mx-auto bg-blue-50 p-8 rounded-lg shadow-md">
  <h1 class="text-2xl font-bold mb-6">Booking for: {{ service.description }}</h1>

  <div class="mb-6 p-4 bg-white border rounded shadow">
    <h2 class="text-xl font-semibold mb-2">Service Summary</h2>
    <p><strong>Description:</strong> {{ service.description }}</p>
    <p><strong>Is Approved:</strong> {{ service.isApproved ? 'Yes' : 'No' }}</p>
    <p><strong>Created On:</strong> {{ service.createdAt | date:'medium' }}</p>
  </div>

  <form (ngSubmit)="submitBooking()" #bookingForm="ngForm" novalidate>
    <div class="mb-4">
      <label for="address" class="block mb-2 font-semibold">Address *</label>
      <input
        id="address"
        type="text"
        [(ngModel)]="address"
        name="address"
        required
        class="w-full p-2 border rounded"
      />
    </div>

    <div class="mb-4">
      <label for="phone" class="block mb-2 font-semibold">Phone *</label>
      <input
        id="phone"
        type="tel"
        [(ngModel)]="phone"
        name="phone"
        required
        class="w-full p-2 border rounded"
      />
    </div>

    <div class="mb-4">
      <label for="bookingDate" class="block mb-2 font-semibold">Booking Date *</label>
      <input
        id="bookingDate"
        type="date"
        [(ngModel)]="bookingDate"
        name="bookingDate"
        required
        class="w-full p-2 border rounded"
      />
    </div>

    <div class="mb-4">
      <label for="timeSlot" class="block mb-2 font-semibold">Time Slot *</label>
      <select
        id="timeSlot"
        [(ngModel)]="timeSlot"
        name="timeSlot"
        required
        class="w-full p-2 border rounded"
      >
        <option value="" disabled selected>-- Select a time slot --</option>
        <option *ngFor="let slot of timeSlots" [value]="slot">{{ slot }}</option>
      </select>
    </div>

    <div class="mb-4">
      <label for="notes" class="block mb-2 font-semibold">Additional Notes</label>
      <textarea
        id="notes"
        [(ngModel)]="notes"
        name="notes"
        rows="4"
        class="w-full p-2 border rounded"
      ></textarea>
    </div>

    <div class="flex gap-4 items-center">
      <button
        type="submit"
        class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-900"
        [disabled]="bookingForm.invalid || submitting"
      >
        <span *ngIf="submitting" class="inline-flex items-center gap-2">
          <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8v8z"
            ></path>
          </svg>
          Booking...
        </span>
        <span *ngIf="!submitting">Confirm Booking</span>
      </button>

      <button
        type="button"
        class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400"
        (click)="cancel()"
        [disabled]="submitting"
      >
        Cancel
      </button>
    </div>

    <div *ngIf="successMessage" class="text-green-600 mt-4 font-semibold">
      {{ successMessage }}
    </div>
  </form>
</div>
